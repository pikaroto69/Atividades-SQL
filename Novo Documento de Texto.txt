UPDATE DEBITOS 
SET SITUACAO_DEBITO = 'Atrasado'
WHERE SITUACAO_DEBITO NOT IN ('Pago', 'Negociado')
AND DATAVENCIMENTO < CURRENT_DATE


UPDATE DEBITOS 
SET SITUACAO_DEBITO = 'Atrasado'
WHERE SITUACAO_DEBITO NOT IN ('Pago')
AND DATAVENCIMENTO > CURRENT_DATE


UPDATE DEBITOS 
SET DATAVENCIMENTO = DATEADD(YEAR, -5 , DATAVENCIMENTO)
WHERE SITUACAO_DEBITO = 'Negociado'

SELECT NOME, EMAIL, TELEFONE
FROM PESSOA p


SELECT PRECO_UNITARIO FROM PRODUTO p 
WHERE PRECO_UNITARIO > 100

SELECT DATA_COMPRA FROM HISTORICO_COMPRAS_CLIENTE hcc 
WHERE DATA_COMPRA > '2023-01-01'


SELECT p.NOME, p.DATA_NASCIMENTO,
EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM p.DATA_NASCIMENTO)
FROM PESSOA p
INNER JOIN FORNECEDOR f ON f.ID_PESSOA = p.ID_PESSOA
INNER JOIN PRODUTO pr ON f.ID_FORNECEDOR = pr.ID_FORNECEDOR
WHERE pr.QUANTIDADE_ESTOQUE IS NULL


SELECT p.NOME 
FROM DEBITOS d
INNER JOIN CLIENTE c ON c.ID_CLIENTE = d.ID_CLIENTE
INNER JOIN PESSOA p ON p.ID_PESSOA = c.ID_PESSOA
WHERE d.SITUACAO_DEBITO = 'Atrasado'







